@startuml

title Промпт-инжиниринг для ИИ
actor Пользователь
participant "Чат-интерфейс"
participant "Помощник по промтам"
participant "ИИ-система"

autonumber

activate Пользователь

group Фрейм 1 [Неудачная попытка]
    Пользователь -> "Чат-интерфейс": Запрос "Напиши рецепт торта"
    activate "Чат-интерфейс"
    "Чат-интерфейс" -> "ИИ-система": Передача запроса
    activate "ИИ-система"
    "Чат-интерфейс" <-- "ИИ-система": Общий рецепт\n торта
    deactivate "ИИ-система"
    Пользователь <-- "Чат-интерфейс": Базовый рецепт
    deactivate "Чат-интерфейс"
    
    note over Пользователь: Недостаточно деталей
end

group Фрейм 2 [Уточнение требований]
    Пользователь -> "Помощник по промтам": Запрос на помощь\n в формулировке
    activate "Помощник по промтам"
    
    "Помощник по промтам" -> Пользователь: Запрос уточнений
    Пользователь -> "Помощник по промтам": Шоколадный торт,\n 8 человек, фото
    
    "Помощник по промтам" -> "Помощник по промтам": Формирование\n улучшенного промта
end

group Фрейм 3 [Генерация шаблона]
    "Помощник по промтам" -> "ИИ-система": Тестовый запрос\n с улучшенным промтом
    activate "ИИ-система"
    "Помощник по промтам" <-- "ИИ-система": Детальный рецепт
    deactivate "ИИ-система"
    
    "Помощник по промтам" -> Пользователь: Передача готового\n шаблона промта
    deactivate "Помощник по промтам"
end

group Фрейм 4 [Использование шаблона]
    Пользователь -> "Чат-интерфейс": Использование\n шаблона промта
    activate "Чат-интерфейс"
    
    alt Немедленное использование
        "Чат-интерфейс" -> "ИИ-система": Отправка\n оптимизированного запроса
        activate "ИИ-система"
        "Чат-интерфейс" <-- "ИИ-система": Идеальный результат
        deactivate "ИИ-система"
        
        Пользователь <-- "Чат-интерфейс": Получение\n детального рецепта
    else Предварительный просмотр
        "Чат-интерфейс" -> Пользователь: Подтверждение\n использования
        Пользователь -> "Чат-интерфейс": Подтверждение
        
        "Чат-интерфейс" -> "ИИ-система": Отправка промта
        activate "ИИ-система"
        "Чат-интерфейс" <-- "ИИ-система": Результат
        deactivate "ИИ-система"
        
        Пользователь <-- "Чат-интерфейс": Результат
    end
    
    deactivate "Чат-интерфейс"
    
    Пользователь -> Пользователь: Сохранение шаблона\n в библиотеку
end

deactivate Пользователь

@enduml